webpackJsonp([42],{517:function(t,e,i){var n=function(t,e){function i(){this.constructor=t}for(var n in e)r.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},r={}.hasOwnProperty,o=function(t,e){return function(){return t.apply(e,arguments)}};void(t.exports=Promise.all([Promise.resolve().then(i.bind(null,1)),Promise.resolve().then(i.bind(null,12)),Promise.resolve().then(i.bind(null,5)),i.e(34).then(i.bind(null,510)),Promise.resolve().then(i.bind(null,7)),i.e(24).then(i.bind(null,500)),i.e(50).then(i.bind(null,578)),i.e(31).then(i.bind(null,511)),i.e(30).then(i.bind(null,508)),i.e(43).then(i.bind(null,523)),i.e(1).then(i.bind(null,527))]).then(function(){return function(t,e,i,r,s,a,u,l,c,h,d){var p,g,f,_,w,m,y,v,j,$,T,b,V,x,C;return y={initializeInput:function(){return this.$(this.input()).attr("autocomplete","country chromehack"),this._onAssociationChange(),this.listenTo(this.collection,"add remove",function(t){return function(){return t._onAssociationChange(!0)}}(this))},idField:function(){return this.$(".js-tagger-ids")},_onAssociationChange:function(t){return this._updateIdField(),this._hideInputIfGreaterThanMax(t)},_updateIdField:function(){var t,e;return t=function(){var t,i,n,r;for(n=this.collection.models,r=[],t=0,i=n.length;t<i;t++)e=n[t],r.push(e.id);return r}.call(this),this.idField().val(t.join())},_hideInputIfGreaterThanMax:function(t){var e,i;if(i=this.$el.data("max"))return e=this.$(this.input()),this.collection.length<i?(e.show(),t?e.focus():void 0):(e.hide(),this.trigger("filled"))}},v=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.initialize=function(t){var n;return this.collection=new e.Collection(function(){var t,e,i,r;for(i=this.$el.data("existing"),r=[],t=0,e=i.length;t<e;t++)n=i[t],r.push(new u(n));return r}.call(this)),r.__super__.initialize.call(this,i.extend({tagType:this.$el.data("type")+"Tag",container:this.$(".js-association-container")},t)),this.initializeInput()},r}(r.NewTagField),i.extend(v.prototype,y),j=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.initialize=function(t){var n;return this.collection=new e.Collection(function(){var t,e,i,r;for(i=this.$el.data("existing"),r=[],t=0,e=i.length;t<e;t++)n=i[t],r.push(new l(n));return r}.call(this)),r.__super__.initialize.call(this,i.extend({tag_type:this.$el.data("type")+"Tag",new_taggable_field:"tags_"+this.$el.data("field"),new_taggable_type:""+this.$el.data("taggable-type"),new_taggable_id:this.$el.data("id"),container:this.$(".js-association-container")},t)),this.initializeInput()},r}(r.NewTaggingField),i.extend(j.prototype,y),$=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.initialize=function(t){var n;return this.collection=new e.Collection(function(){var t,e,i,r;for(i=this.$el.data("existing"),r=[],t=0,e=i.length;t<e;t++)n=i[t],r.push(new c(n));return r}.call(this)),r.__super__.initialize.call(this,i.extend({container:this.$(".js-association-container")},t)),this.initializeInput()},r}(r.StartupField),i.extend($.prototype,y),x=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.initialize=function(t){var n;return this.collection=new e.Collection(function(){var t,e,i,r;for(i=this.$el.data("existing"),r=[],t=0,e=i.length;t<e;t++)n=i[t],r.push(new h(n));return r}.call(this)),r.__super__.initialize.call(this,i.extend({container:this.$(".js-association-container")},t)),this.initializeInput()},r}(r.UserField),i.extend(x.prototype,y),C=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,e),r.prototype.removeSubView=function(t){return this.stopListening(t),t.remove()},r.prototype.renderTemplate=function(e,n){var r;return r={interpolate:/\{\{(.+?)\}\}/g,evaluate:/\{\-(.+?)\-\}/g,escape:/\{\{\-(.+?)\-\}\}/g},i.template(t(e).html(),n,r)},r}(e.View),p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.events={"click .js-add":"add","click .js-cancel":"cancel"},e.prototype.add=function(){if(!this.$(".js-add").hasClass("c-button--loading"))return this.$(".js-add").addClass("c-button--loading"),this.$(".js-cancel").addClass("c-button--disabled"),this.trigger("add")},e.prototype.cancel=function(){return this.reset(),this.trigger("cancel")},e.prototype.reset=function(){return this.$(".js-add").removeClass("c-button--loading"),this.$(".js-cancel").removeClass("c-button--disabled")},e}(e.View),f=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.initialize=function(){return this.controlGroup=new p({el:this.$(".js-add-cancel-group")}),this.listenTo(this.controlGroup,"cancel",function(t){return function(){return t.trigger("cancel")}}(this)),this.listenTo(this.controlGroup,"add",function(t){return function(){return t.add()}}(this))},e.prototype.add=function(){var t;if(t=this.create(),!t.isValid())return this.showErrors(t.validationError)},e.prototype.create=function(){return this.collection.create(this.attributes())},e.prototype.showErrors=function(t){return this.show({clear:!1}),this.$(".js-errors").show().html(t.join("<br>"))},e.prototype.show=function(t){var e,n;return null==t&&(t={}),n=i.extend({focus:!0,clear:!0},t),this.controlGroup.reset(),t.doNotShowElement||this.$el.show(),e=this.$("input[type='text'],select,textarea").not("[name='user_id']"),n.clear&&e.val(""),n.clearId&&this.$("input[type='hidden'][name='id']").val(""),n.focus&&e.filter(":visible").first().focus(),this.$(".js-errors").hide()},e.prototype.attributes=function(){var t,e,i,n,r;for(t={},r=this.fields,i=0,n=r.length;i<n;i++)e=r[i],t[e]=this.$("[name='"+e+"']").val();return t},e}(e.View),b=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.events={"click .js-add-new-tagging":"showNewTaggingView"},e.prototype.initialize=function(){return this.collection=new this.collectionClass,this.listenTo(this.collection,"reset",function(t){return function(){return t.collectionReset()}}(this)),this.listenTo(this.collection,"remove",function(t){return function(e){return t.collectionRemove(e)}}(this)),this.collection.reset(this.$el.data("taggings")),this.addNewTaggingView=new this.newTaggingViewClass({el:this.$(".js-new-form"),collection:this.collection}),this.listenTo(this.addNewTaggingView,"cancel",function(t){return function(){return t.hideTaggingView()}}(this))},e.prototype.collectionRemove=function(t){var e;if(e=i.find(this.rowViews,function(e){return e.model.id===t.id}))return this.removeSubView(e),this.rowViews.splice(i.indexOf(this.rowViews,e),1)},e.prototype.collectionReset=function(){var t,e,n,r,o,s,a,u,l,c;if(!i.isEmpty(this.rowViews))for(a=this.rowViews,e=0,r=a.length;e<r;e++)c=a[e],c.remove();for(this.rowViews=[],t=this.$(".js-list-container"),u=this.collection.models,l=[],n=0,o=u.length;n<o;n++)s=u[n],c=new this.rowViewClass({model:s}),this.rowViews.push(c),l.push(t.append(c.el));return l},e.prototype.showNewTaggingView=function(t){return this.$(".js-add-new-tagging").hide(),this.addNewTaggingView.show(t)},e.prototype.hideTaggingView=function(){return this.$(".js-add-new-tagging").show(),this.addNewTaggingView.$el.hide()},e}(C),m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.collectionReset=function(){var t,i,n,r;for(e.__super__.collectionReset.apply(this,arguments),n=this.rowViews,t=0,i=n.length;t<i;t++)r=n[t],this.listenTo(r,"edit",function(t){return function(e){return t.editTagging(e)}}(this));if(this.addNewTaggingView)return this.isEditing?this.hideTaggingView():this.showNewTaggingView()},e.prototype.editTagging=function(t){return this.isEditing=!0,this.$(".js-add-new-tagging").hide(),this.addNewTaggingView.edit(t)},e.prototype.hideTaggingView=function(){return this.isEditing=!1,e.__super__.hideTaggingView.apply(this,arguments)},e}(b),T=function(e){function i(){return this.save_tagging=o(this.save_tagging,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.save_tagging=function(e){return t.ajax({url:this.createURL,type:"post",data:e.attributes,success:function(t){return function(e){return t.reset(e.taggings)}}(this)})},i.prototype.create=function(e){var i;return i=new this.model(e),i.isValid()&&(t.isFunction(i.createPopover)?t.when(i.createPopover(this.save_tagging)).then(function(t){return function(e){if(e.proceed)return t.save_tagging(i)}}(this)):this.save_tagging(i)),i},i}(e.Collection),V=function(e){function i(){return this.render=o(this.render,this),this.delete_tag=o(this.delete_tag,this),this.initialize=o(this.initialize,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.initialize=function(){return this.$(".delete > a",this).removeAttr("onClick")},i.prototype.events={"click img.delete":"delete_tag"},i.prototype.delete_tag=function(t){return this.$el.css("opacity","0.7"),t.preventDefault(),this.model.isNew()?(this.model.destroy(),this.$el.fadeOut(function(t){return function(){return t.remove()}}(this))):this.model.destroy({wait:!0,success:function(t){return function(){return t.$el.fadeOut(function(){return t.remove()})}}(this)})},i.prototype.render=function(){var e;return e='<div data-tag_id="'+this.model.get("new_tag").id+'" class="new_taggings tag_edit">\n  <a href="'+this.model.get("new_tag").slug_url+'" target="_blank">'+this.model.get("new_tag").display_name+'</a>\n  <img class="delete" src="/images/tag-field/close-tag.png" title="Remove"/>\n  </div>',this.$el=t(e).data("new_tagging",this.model.toJSON()),this.el=this.$el.get()[0],this.delegateEvents(),this},i}(e.View),w=function(e){function i(){return this.save_degree=o(this.save_degree,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.model=d,i.prototype.save_degree=function(t){return t.save(t.attributes,{success:function(t){return function(e,i){return t.reset(i.all_degrees)}}(this)})},i.prototype.create=function(e){var i;return i=new this.model(e),i.isValid()&&t.when(this.createPopover(i,this.save_degree)).then(function(t){return function(e){if(e.proceed)return t.save_degree(i)}}(this)),i},i.prototype.createPopover=function(e,i){var n;return n="new_tags/create_popover",t.ajax({url:"/"+n,data:{name:e.get("name"),tag_type:"CollegeTag"},success:function(r){return function(r){var o;return r.proceed||(o=t(r.create_popover_html),t.facybox(o),setTimeout(function(){return s["with"](t(s.selector(n)),function(t){return t.set({model:e,callback:i})})},100)),r}}(this)})},i}(e.Collection),_=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.className="college-row-view",e.prototype.events=function(){return{"click .js-edit":function(t){return function(){return t.trigger("edit",t.model)}}(this),"click .js-delete":function(t){return function(){return t.model.destroy()}}(this)}},e.prototype.initialize=function(){return this.render()},e.prototype.metaData=function(){var t,e,n,r,o,s,a;return s=[this.model.get("majors")||[],this.model.get("degree_name"),this.model.get("graduation_month_name"),this.model.get("graduation_year")],o=s[0],t=s[1],e=s[2],n=s[3],r=o.join(", "),a="",(t||r)&&(a="&middot; "),a+=i.compact([t,r]).join(", "),n&&(e&&(a+=" "+e),a+=" "+n),a},e.prototype.render=function(){var t;return t=i.extend(this.model.toJSON(),{meta_data:this.metaData()}),this.$el.html(this.renderTemplate("#college-row-template",t))},e}(C),g=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,e),r.prototype.fields=["name","user_id","majors","degree_type","full_degree_name","graduation_year","graduation_month","id","description"],r.prototype.initialize=function(){var t;return r.__super__.initialize.apply(this,arguments),t=new a.TagAutocomplete({el:this.$("input[name='name']"),tag_type:"CollegeTag"}),this.listenTo(t,"select",function(t){return function(e){return t.$("input[name='name']").attr("value",e.tag.display_name),t._focusLastMajorInput()}}(this)),this.$(".js-add-major").click(function(t){return function(){return t.addMajorRow()}}(this)),this.$("select[name='degree_type']").change(function(t){return function(){return t.degreeSelectionChanged()}}(this))},r.prototype.show=function(t){return r.__super__.show.call(this,t),this.degreeSelectionChanged(),this.renderMajorTextFields((null!=t?t.majors:void 0)||[])},r.prototype.degreeSelectionChanged=function(){var t,e,n,r;if(r=this.$el.data("degree_types_to_show_other_input"),e=parseInt(this.$("select[name='degree_type']").val()),n=i.contains(r,e),t=this.$("input[name='full_degree_name']"),t.toggle(n),!n)return t.val("")},r.prototype.renderMajorTextFields=function(e){var n,r,o;return o=Math.max(e.length,1),r=this.$(".js-major-row:first")[0].outerHTML,this.$(".js-major-row").remove(),n=this.$(".js-add-major-row"),i(o).times(function(){return n.before(r)}),i.each(i.zip(this.$(".js-major-input"),e),function(e){var i,n;if(i=e[0],n=e[1])return t(i).val(n)})},r.prototype.addMajorRow=function(){var t;return t=this.$(".js-major-row:last")[0].outerHTML,this.$(".js-add-major-row").before(t),this._focusLastMajorInput()},r.prototype.add=function(){var t,e;if(this.$("input, a").blur(),null!=(e=this.attributes().id)?e.length:void 0)t=this.update();else if(t=this.create(),t.isValid())return;if(t.validationError)return this.showErrors(t.validationError)},r.prototype.update=function(){var t;return t=this.collection.find(function(t){return function(e){return parseInt(e.get("id"))===parseInt(t.attributes().id)}}(this)),t.save(this.attributes(),{success:function(t){return function(e,i){return t.collection.reset(i.all_degrees)}}(this)}),t},r.prototype.edit=function(t){var e,i,n,r;for(r=this.fields,i=0,n=r.length;i<n;i++)e=r[i],"user_id"!==e&&"majors"!==e&&this.$("[name='"+e+"']").attr("value",t.get(e)||"");return this.show({clear:!1,majors:t.get("majors")})},r.prototype.attributes=function(){var e,n,o;return o=r.__super__.attributes.call(this),e=i.inject(i.keys(o),function(t,e){return o[e]&&(t[e]=o[e]),t},{}),n=i.map(this.$(".js-major-input"),function(e){return t(e).val()}),n=i.compact(n),e.majors=n,e},r.prototype._focusLastMajorInput=function(){return this.$(".js-major-input:last").focus()},r}(f),{LimitAssociationMixin:y,NewTagField:v,NewTaggingField:j,StartupField:$,UserField:x,View:C,TaggingView:V,TaggingList:b,TaggingCollection:T,AddTaggingView:f,EditableTaggingList:m,DegreeCollection:w,CollegeRow:_,AddEditDegreeView:g}}.apply(void 0,arguments[0])}.bind(this)))}});